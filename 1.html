<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台電批次帳單匯出流程圖</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .canvas-bg {
            background-color: #f8fafc;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- 控制面板 -->
    <div class="mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex gap-4 items-center max-w-2xl w-full justify-between">
        <div>
            <h1 class="text-lg font-bold text-slate-800">⚡ 3分鐘完成電費資料收集</h1>
            <p class="text-sm text-slate-500">免找紙本，一鍵匯出全年碳盤查數據</p>
        </div>
        <button id="download-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 shadow-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            下載 SVG 圖片
        </button>
    </div>

    <!-- 獨立的 SVG 容器，方便直接另存 -->
    <div id="svg-wrapper" class="bg-white p-8 rounded-2xl shadow-lg border border-slate-200 overflow-hidden canvas-bg flex justify-center w-full max-w-4xl">
        
        <!-- 手工打造的高質感 SVG 流程圖 -->
        <svg id="workflow-svg" xmlns="http://www.w3.org/2000/svg" width="800" height="450" viewBox="0 0 800 450" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">
            <defs>
                <!-- 箭頭定義 -->
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                </marker>
                <!-- 陰影定義 -->
                <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
                    <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#0f172a" flood-opacity="0.08"/>
                </filter>
                <filter id="shadow-light" x="-10%" y="-10%" width="120%" height="120%">
                    <feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#0f172a" flood-opacity="0.05"/>
                </filter>
            </defs>

            <!-- ================= 連線 (Edges) ================= -->
            <!-- 步驟1 到 步驟2 -->
            <path d="M 200 120 C 200 180, 200 180, 200 240" fill="none" stroke="#64748b" stroke-width="3" stroke-dasharray="6,4" marker-end="url(#arrowhead)"/>
            
            <!-- 步驟2 到 步驟3 -->
            <path d="M 200 320 C 200 370, 360 370, 400 370" fill="none" stroke="#64748b" stroke-width="3" stroke-dasharray="6,4" marker-end="url(#arrowhead)"/>
            
            <!-- 大方向箭頭：免紙本直接跳到最後 -->
            <path d="M 600 120 C 600 240, 600 240, 600 330" fill="none" stroke="#3b82f6" stroke-width="4" marker-end="url(#arrowhead)"/>
            
            <!-- 連接說明文字 -->
            <line x1="280" y1="80" x2="350" y2="80" stroke="#cbd5e1" stroke-width="2"/>
            <line x1="280" y1="280" x2="350" y2="280" stroke="#cbd5e1" stroke-width="2"/>
            <line x1="680" y1="370" x2="720" y2="370" stroke="#cbd5e1" stroke-width="2"/>


            <!-- ================= 節點 (Nodes) ================= -->
            
            <!-- 標題區域 -->
            <rect x="50" y="20" width="700" height="40" rx="8" fill="#f1f5f9" />
            <text x="400" y="45" text-anchor="middle" font-size="16" font-weight="bold" fill="#334155">【企業碳盤查】台電電子帳單 批次匯出流程</text>

            <!-- 步驟 1 -->
            <g transform="translate(120, 60)">
                <rect width="160" height="60" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#3b82f6" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">1</text>
                <text x="80" y="35" text-anchor="middle" font-size="15" font-weight="bold" fill="#1e293b">登入台電系統</text>
            </g>
            <!-- 步驟 1 說明 -->
            <g transform="translate(350, 65)">
                <rect width="180" height="50" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow-light)"/>
                <text x="90" y="23" text-anchor="middle" font-size="12" fill="#475569">使用公司「統編」與「密碼」</text>
                <text x="90" y="40" text-anchor="middle" font-size="12" fill="#475569">登入電子帳單服務網</text>
            </g>

            <!-- 步驟 2 -->
            <g transform="translate(120, 240)">
                <rect width="160" height="80" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#3b82f6" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">2</text>
                <text x="80" y="35" text-anchor="middle" font-size="15" font-weight="bold" fill="#1e293b">選擇批次匯出</text>
                <text x="80" y="55" text-anchor="middle" font-size="12" fill="#64748b">帳單查詢 > 明細匯出</text>
            </g>
            <!-- 步驟 2 說明 -->
            <g transform="translate(350, 255)">
                <rect width="180" height="50" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow-light)"/>
                <text x="90" y="23" text-anchor="middle" font-size="12" fill="#475569">選擇需盤查的年度區間</text>
                <text x="90" y="40" text-anchor="middle" font-size="12" fill="#475569">(例如：113年1月~12月)</text>
            </g>

            <!-- 痛點對比 (右側) -->
            <g transform="translate(520, 60)">
                <rect width="160" height="60" rx="8" fill="#fee2e2" stroke="#fca5a5" stroke-width="2" stroke-dasharray="4"/>
                <text x="80" y="30" text-anchor="middle" font-size="14" font-weight="bold" fill="#b91c1c">❌ 傳統方式</text>
                <text x="80" y="48" text-anchor="middle" font-size="12" fill="#991b1b">翻找一整年紙本帳單</text>
            </g>

            <!-- 最終成果：步驟 3 -->
            <g transform="translate(400, 330)">
                <rect width="280" height="80" rx="12" fill="#ecfeff" stroke="#06b6d4" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#0ea5e9" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">3</text>
                <text x="140" y="35" text-anchor="middle" font-size="16" font-weight="bold" fill="#0369a1">✅ 一鍵下載 Excel 總表</text>
                <text x="140" y="55" text-anchor="middle" font-size="13" font-weight="bold" fill="#0ea5e9">包含所有廠區度數與「碳排量」</text>
            </g>

            <!-- 後續動作 -->
            <g transform="translate(720, 350)">
                <rect width="60" height="40" rx="4" fill="#22c55e" filter="url(#shadow-light)"/>
                <text x="30" y="20" text-anchor="middle" font-size="12" font-weight="bold" fill="white">交給</text>
                <text x="30" y="34" text-anchor="middle" font-size="12" font-weight="bold" fill="white">顧問</text>
            </g>

            <!-- 裝飾性線條與標籤 -->
            <rect x="170" y="155" width="60" height="20" rx="10" fill="#e2e8f0" />
            <text x="200" y="169" text-anchor="middle" font-size="11" font-weight="bold" fill="#64748b">系統自動</text>

            <rect x="570" y="180" width="60" height="20" rx="10" fill="#bfdbfe" />
            <text x="600" y="194" text-anchor="middle" font-size="11" font-weight="bold" fill="#1d4ed8">3 分鐘搞定</text>

        </svg>
    </div>

    <!-- 腳本：處理下載功能 -->
    <script>
        document.getElementById('download-btn').addEventListener('click', () => {
            const svgElement = document.getElementById('workflow-svg');
            
            // 獲取 SVG 字串
            const serializer = new XMLSerializer();
            let source = serializer.serializeToString(svgElement);

            // 加入 XML 宣告
            if(!source.match(/^<\?xml[^>]+>/)){
                source = '<?xml version="1.0" standalone="no"?>\r\n' + source;
            }

            // 轉換為 Blob
            const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
            const url = URL.createObjectURL(blob);

            // 建立虛擬連結並觸發下載
            const link = document.createElement("a");
            link.href = url;
            link.download = "台電電費單匯出流程.svg";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
</body>
</html>
