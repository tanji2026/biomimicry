<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>操作說明 - 台電電子帳單批次匯出流程</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            background-color: #f1f5f9;
        }
    </style>
</head>
<body class="min-h-screen flex flex-col items-center py-10 px-4">

    <!-- 頂部控制列 -->
    <div class="mb-6 bg-white px-6 py-4 rounded-lg shadow-sm border border-slate-200 flex gap-6 items-center max-w-4xl w-full justify-between">
        <div>
            <h1 class="text-xl font-bold text-slate-800">台電電子帳單服務系統 - 批次明細匯出操作說明</h1>
            <p class="text-sm text-slate-500 mt-1">適用對象：需匯出單一統編下多個廠區、樓層電號資料之企業承辦人員</p>
        </div>
        <button id="download-btn" class="bg-slate-700 hover:bg-slate-800 text-white px-4 py-2 rounded text-sm font-medium transition-colors flex items-center gap-2 whitespace-nowrap">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            下載說明圖 (SVG)
        </button>
    </div>

    <!-- 獨立的 SVG 容器 -->
    <div id="svg-wrapper" class="bg-white p-8 rounded-lg shadow-md border border-slate-200 overflow-x-auto flex justify-center w-full max-w-4xl">
        
        <!-- 專業版 SVG 說明圖 -->
        <svg id="workflow-svg" xmlns="http://www.w3.org/2000/svg" width="850" height="700" viewBox="0 0 850 700" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif; background-color: #ffffff;">
            <defs>
                <!-- 箭頭標記 -->
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                </marker>
                <!-- 專業的輕微陰影 -->
                <filter id="shadow" x="-5%" y="-5%" width="110%" height="110%">
                    <feDropShadow dx="0" dy="2" stdDeviation="3" flood-color="#0f172a" flood-opacity="0.06"/>
                </filter>
            </defs>

            <!-- ================= 標題區 ================= -->
            <rect x="80" y="30" width="690" height="46" rx="6" fill="#f8fafc" stroke="#e2e8f0" stroke-width="1"/>
            <text x="425" y="58" text-anchor="middle" font-size="18" font-weight="bold" fill="#1e293b">【操作手冊】企業多電號電費及碳排資料批次匯出流程</text>

            <!-- ================= 主流程線 (連線) ================= -->
            <!-- Step 1 to 2 -->
            <path d="M 320 180 L 320 220" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
            <!-- Step 2 to 3 -->
            <path d="M 320 290 L 320 330" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
            <!-- Step 3 to 4 -->
            <path d="M 320 400 L 320 440" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
            <!-- Step 4 to 5 -->
            <path d="M 320 510 L 320 550" fill="none" stroke="#64748b" stroke-width="2" marker-end="url(#arrowhead)"/>
            
            <!-- 虛線連線至側邊說明框 -->
            <path d="M 560 365 L 590 365" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="4,4"/>
            <path d="M 560 592 L 590 592" fill="none" stroke="#94a3b8" stroke-width="2" stroke-dasharray="4,4"/>


            <!-- ================= 左側主流程節點 ================= -->
            
            <!-- Step 1 -->
            <g transform="translate(80, 110)">
                <rect width="480" height="70" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5" filter="url(#shadow)"/>
                <!-- 序號圖示 -->
                <circle cx="40" cy="35" r="16" fill="#334155" />
                <text x="40" y="40" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">1</text>
                <!-- 文字內容 -->
                <text x="75" y="32" font-size="15" font-weight="bold" fill="#1e293b">準備登入資料</text>
                <text x="75" y="52" font-size="13" fill="#475569">請先備妥企業之「統一編號」及對應的「系統登入密碼」</text>
            </g>

            <!-- Step 2 -->
            <g transform="translate(80, 220)">
                <rect width="480" height="70" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5" filter="url(#shadow)"/>
                <circle cx="40" cy="35" r="16" fill="#334155" />
                <text x="40" y="40" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">2</text>
                <text x="75" y="32" font-size="15" font-weight="bold" fill="#1e293b">登入台電系統</text>
                <text x="75" y="52" font-size="13" fill="#475569">進入「台電電子帳單服務網」，輸入統一編號及密碼完成身分驗證</text>
            </g>

            <!-- Step 3 -->
            <g transform="translate(80, 330)">
                <rect width="480" height="70" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5" filter="url(#shadow)"/>
                <circle cx="40" cy="35" r="16" fill="#334155" />
                <text x="40" y="40" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">3</text>
                <text x="75" y="32" font-size="15" font-weight="bold" fill="#1e293b">選擇批次匯出功能</text>
                <text x="75" y="52" font-size="13" fill="#475569">於系統主選單中，依序點選功能路徑：「帳單查詢」>「批次帳單明細匯出」</text>
            </g>

            <!-- Step 4 -->
            <g transform="translate(80, 440)">
                <rect width="480" height="70" rx="6" fill="#ffffff" stroke="#cbd5e1" stroke-width="1.5" filter="url(#shadow)"/>
                <circle cx="40" cy="35" r="16" fill="#334155" />
                <text x="40" y="40" text-anchor="middle" font-size="14" font-weight="bold" fill="#ffffff">4</text>
                <text x="75" y="32" font-size="15" font-weight="bold" fill="#1e293b">設定資料區間並下載</text>
                <text x="75" y="52" font-size="13" fill="#475569">設定所需盤查之年度與月份區間（例如：113年1月 至 113年12月），點擊匯出</text>
            </g>

            <!-- Step 5: 產出成果 -->
            <g transform="translate(80, 550)">
                <rect width="480" height="85" rx="6" fill="#f0f9ff" stroke="#0ea5e9" stroke-width="2" filter="url(#shadow)"/>
                <!-- 勾選圖示 -->
                <circle cx="40" cy="42.5" r="16" fill="#0ea5e9" />
                <path d="M 33 42.5 L 38 47.5 L 47 37.5" fill="none" stroke="#ffffff" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>
                
                <text x="75" y="32" font-size="15" font-weight="bold" fill="#0369a1">產出結果：獲取全公司電費與碳排總表 (Excel 格式)</text>
                <text x="75" y="54" font-size="13" fill="#0f766e">報表內將自動列出該統編下「所有廠區與樓層電號」之各期用電度數</text>
                <text x="75" y="74" font-size="13" fill="#0f766e">並附帶台電計算之「本期碳排量」，可直接作為碳盤查之佐證數據</text>
            </g>

            <!-- ================= 右側說明面板 ================= -->
            
            <!-- 面板 1：多電號機制說明 -->
            <g transform="translate(590, 310)">
                <rect width="180" height="150" rx="4" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"/>
                <rect x="0" y="0" width="180" height="30" rx="4" fill="#e2e8f0"/>
                <!-- 資訊圖示 -->
                <circle cx="15" cy="15" r="7" fill="#64748b"/>
                <text x="15" y="19" text-anchor="middle" font-size="10" font-weight="bold" fill="#ffffff">i</text>
                <text x="30" y="20" font-size="13" font-weight="bold" fill="#334155">多電號歸戶機制說明</text>
                
                <text x="12" y="55" font-size="12" fill="#475569">系統以「統一編號」為單位</text>
                <text x="12" y="75" font-size="12" fill="#475569">只要申辦時綁定於同一統編</text>
                <text x="12" y="95" font-size="12" fill="#475569">無論企業分布於多少廠區</text>
                <text x="12" y="115" font-size="12" fill="#475569">或擁有多少樓層之獨立電表</text>
                <text x="12" y="135" font-size="12" fill="#475569">皆會自動彙整於同一報表中</text>
            </g>

            <!-- 面板 2：資料用途說明 -->
            <g transform="translate(590, 560)">
                <rect width="180" height="65" rx="4" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1"/>
                <rect x="0" y="0" width="180" height="30" rx="4" fill="#e2e8f0"/>
                <!-- 文件圖示 -->
                <path d="M 11 10 L 19 10 L 19 20 L 11 20 Z" fill="none" stroke="#64748b" stroke-width="1.5"/>
                <path d="M 13 13 L 17 13 M 13 16 L 17 16" fill="none" stroke="#64748b" stroke-width="1"/>
                <text x="30" y="20" font-size="13" font-weight="bold" fill="#334155">資料用途提醒</text>
                
                <text x="12" y="50" font-size="12" fill="#475569">匯出之 Excel 檔請妥善保存</text>
            </g>

        </svg>
    </div>

    <!-- 腳本：處理下載功能 -->
    <script>
        document.getElementById('download-btn').addEventListener('click', () => {
            const svgElement = document.getElementById('workflow-svg');
            const serializer = new XMLSerializer();
            let source = serializer.serializeToString(svgElement);

            if(!source.match(/^<\?xml[^>]+>/)){
                source = '<?xml version="1.0" standalone="no"?>\r\n' + source;
            }

            const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
            const url = URL.createObjectURL(blob);

            const link = document.createElement("a");
            link.href = url;
            link.download = "操作手冊_台電多電號匯出流程.svg";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
</body>
</html>
