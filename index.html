<!DOCTYPE html>
<html lang="zh-TW" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="robots" content="noindex,nofollow">
    <title>MycoTanJi | 仿生社區碳循環系統</title>
    <meta name="description" content="2026 台灣仿生設計競賽參賽作品 - 基於菌絲網絡邏輯的社區碳循環平台">
    
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;500;700;900&family=Space+Grotesk:wght@300;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        sans: ['Noto Sans TC', 'sans-serif'],
                        mono: ['Space Grotesk', 'monospace'],
                    },
                    colors: {
                        bio: {
                            dark: '#0f172a',
                            light: '#f1f5f9',
                            accent: '#10b981', // Emerald 500
                            fungi: '#fbbf24',  // Amber 400
                            soil: '#78350f',   // Brown
                        }
                    },
                    backgroundImage: {
                        'hero-pattern': "url('https://images.unsplash.com/photo-1511497584788-876760111969?auto=format&fit=crop&q=80&w=2000')",
                        'noise': "url('https://www.transparenttextures.com/patterns/stardust.png')",
                    },
                    animation: {
                        'float': 'float 6s ease-in-out infinite',
                        'pulse-slow': 'pulse 4s cubic-bezier(0.4, 0, 0.6, 1) infinite',
                        'grow': 'grow 0.5s ease-out forwards',
                        'highlight': 'highlight 2s ease-out infinite',
                    },
                    keyframes: {
                        float: {
                            '0%, 100%': { transform: 'translateY(0)' },
                            '50%': { transform: 'translateY(-20px)' },
                        },
                        grow: {
                            '0%': { opacity: '0', transform: 'scale(0.9) translateY(20px)' },
                            '100%': { opacity: '1', transform: 'scale(1) translateY(0)' },
                        },
                        highlight: {
                            '0%': { boxShadow: '0 0 0 0 rgba(16, 185, 129, 0.7)', borderColor: '#10b981' },
                            '70%': { boxShadow: '0 0 0 20px rgba(16, 185, 129, 0)', borderColor: '#10b981' },
                            '100%': { boxShadow: '0 0 0 0 rgba(16, 185, 129, 0)', borderColor: 'rgba(255, 255, 255, 0.1)' }
                        }
                    }
                }
            }
        }
    </script>
    <style>
        .glass-panel {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(12px);
            -webkit-backdrop-filter: blur(12px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .text-glow {
            text-shadow: 0 0 20px rgba(16, 185, 129, 0.5);
        }
        /* Timeline Line */
        .timeline-line {
            position: absolute;
            left: 20px;
            top: 0;
            bottom: 0;
            width: 2px;
            background: linear-gradient(to bottom, #10b981, #0f172a);
        }
        @media (min-width: 768px) {
            .timeline-line {
                left: 50%;
                transform: translateX(-50%);
            }
        }
        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: #0f172a; }
        ::-webkit-scrollbar-thumb { background: #334155; border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: #10b981; }

        .new-entry-highlight {
            animation: highlight 2s ease-out 2;
            border-color: #10b981 !important;
        }

        /* --- Network Canvas Styles --- */
        .network-container {
            position: relative;
            width: 100%;
            height: 500px; /* 固定高度以適應 Canvas */
            background: linear-gradient(to bottom, #1a2f1a 0%, #0a0d0a 100%);
            border-radius: 1rem;
            overflow: hidden;
        }
        .trees-bg {
            position: absolute;
            top: 0;
            width: 100%;
            height: 45%;
            background: url('https://images.unsplash.com/photo-1448375240586-882707db888b?auto=format&fit=crop&q=80&w=800') center bottom/cover no-repeat;
            mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
            -webkit-mask-image: linear-gradient(to bottom, black 60%, transparent 100%);
            opacity: 0.8;
            pointer-events: none;
        }
        .ground-line {
            position: absolute;
            top: 45%;
            width: 100%;
            height: 2px;
            background: rgba(139, 94, 60, 0.4);
            box-shadow: 0 0 20px rgba(0, 255, 100, 0.2);
            z-index: 10;
        }
        canvas#network-canvas {
            position: absolute;
            top: 45%; /* 從地面開始 */
            left: 0;
            width: 100%;
            height: 55%; /* 佔據剩餘空間 */
            z-index: 5;
        }
        .floating-label {
            position: absolute;
            font-size: 0.75rem;
            font-weight: bold;
            text-shadow: 0 0 5px rgba(0,0,0,0.8);
            pointer-events: none;
            z-index: 15;
            transition: opacity 0.5s;
        }
        /* 互動選項樣式 */
        .interactive-option {
            transition: all 0.3s ease;
            cursor: pointer;
            border: 1px solid transparent;
        }
        .interactive-option:hover, .interactive-option.active {
            background: rgba(255, 255, 255, 0.05);
            border-color: rgba(16, 185, 129, 0.3);
            transform: translateX(10px);
        }
        .interactive-option.active .icon-box {
            background: rgba(16, 185, 129, 0.2);
            color: #10b981;
            box-shadow: 0 0 15px rgba(16, 185, 129, 0.4);
        }
    </style>
</head>
<body class="bg-bio-dark text-slate-200 antialiased selection:bg-bio-accent selection:text-bio-dark relative">

    <!-- Fixed Navigation -->
    <nav class="fixed w-full z-50 glass-panel border-b border-white/5">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between items-center h-20">
                <div class="flex items-center gap-3 cursor-pointer" onclick="window.scrollTo(0,0)">
                    <div class="relative w-10 h-10 flex items-center justify-center">
                        <i class="fa-solid fa-circle-nodes text-bio-accent text-3xl animate-pulse-slow"></i>
                    </div>
                    <div class="flex flex-col">
                        <span class="font-bold text-xl tracking-wider text-white">Myco<span class="text-bio-accent">TanJi</span></span>
                        <span class="text-[10px] text-slate-400 tracking-[0.2em] uppercase">Biomimicry Carbon Lab</span>
                    </div>
                </div>
                
                <div class="hidden md:flex space-x-6 items-center">
                    <a href="#concept" class="text-sm font-medium text-slate-300 hover:text-bio-accent transition">仿生概念</a>
                    <a href="#solution" class="text-sm font-medium text-slate-300 hover:text-bio-accent transition">運作機制</a>
                    <a href="#timeline" class="text-sm font-medium text-slate-300 hover:text-bio-accent transition">生態演替</a>
                    <a href="#dashboard" class="text-sm font-medium text-slate-300 hover:text-bio-accent transition">碳儀表板</a>
                    <a href="#impact" class="text-sm font-medium text-slate-300 hover:text-bio-accent transition">永續效益</a>
                    <div class="px-3 py-1 rounded-full border border-bio-accent/30 text-bio-accent text-xs font-mono">
                        <span class="w-2 h-2 rounded-full bg-bio-accent inline-block mr-2 animate-pulse"></span>System Online
                    </div>
                </div>
            </div>
        </div>
    </nav>

    <!-- Floating Action Button (FAB) -->
    <button onclick="toggleInputModal()" class="fixed bottom-8 right-8 z-[60] w-16 h-16 rounded-full bg-bio-accent hover:bg-emerald-400 text-bio-dark shadow-[0_0_20px_rgba(16,185,129,0.5)] flex items-center justify-center transition-all transform hover:scale-110 group">
        <i class="fa-solid fa-plus text-2xl group-hover:rotate-90 transition-transform duration-300"></i>
        <span class="absolute -top-10 right-0 bg-white text-bio-dark text-xs px-2 py-1 rounded font-bold opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap">注入營養源</span>
    </button>

    <!-- Input Modal -->
    <div id="inputModal" class="fixed inset-0 z-[70] hidden">
        <div class="absolute inset-0 bg-black/80 backdrop-blur-sm" onclick="toggleInputModal()"></div>
        <div class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2 w-full max-w-md p-6">
            <div class="glass-panel border border-bio-accent/30 rounded-2xl shadow-2xl relative overflow-hidden">
                <div class="absolute top-0 left-0 w-full h-1 bg-gradient-to-r from-bio-accent to-blue-500"></div>
                <div class="p-6">
                    <div class="flex justify-between items-center mb-6">
                        <h3 class="text-xl font-bold text-white flex items-center gap-2">
                            <i class="fa-solid fa-flask text-bio-accent"></i> 營養注入
                        </h3>
                        <button onclick="toggleInputModal()" class="text-slate-400 hover:text-white"><i class="fa-solid fa-xmark text-xl"></i></button>
                    </div>
                    <form id="dataForm" onsubmit="handleDataSubmit(event)" class="space-y-4">
                        <div>
                            <label class="block text-xs font-mono text-bio-accent mb-1 uppercase">Source / 來源</label>
                            <select id="inputSource" class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-white focus:border-bio-accent focus:outline-none transition">
                                <option value="Starbucks">Starbucks 星巴克</option>
                                <option value="Louisa">Louisa 路易莎</option>
                                <option value="FamilyMart">FamilyMart 全家</option>
                                <option value="7-11">7-ELEVEN</option>
                                <option value="Community">社區家庭回收</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-4">
                            <div>
                                <label class="block text-xs font-mono text-bio-accent mb-1 uppercase">Type / 類型</label>
                                <select id="inputType" class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-white focus:border-bio-accent focus:outline-none transition">
                                    <option value="Coffee Grounds">咖啡渣</option>
                                    <option value="Food Waste">生廚餘</option>
                                    <option value="Leaves">落葉碳源</option>
                                    <option value="Harvest">香草採收</option>
                                </select>
                            </div>
                            <div>
                                <label class="block text-xs font-mono text-bio-accent mb-1 uppercase">Mass / 重量 (kg)</label>
                                <input type="number" id="inputWeight" step="0.1" required class="w-full bg-slate-800/50 border border-slate-600 rounded-lg p-3 text-white focus:border-bio-accent focus:outline-none transition" placeholder="0.0">
                            </div>
                        </div>
                        <div>
                            <label class="block text-xs font-mono text-bio-accent mb-1 uppercase">Evidence / 現場紀錄</label>
                            <div class="relative border-2 border-dashed border-slate-600 rounded-lg p-4 text-center hover:border-bio-accent transition cursor-pointer" onclick="document.getElementById('inputImage').click()">
                                <input type="file" id="inputImage" class="hidden" accept="image/*" onchange="previewImage(this)">
                                <div id="imagePreviewBox">
                                    <i class="fa-solid fa-camera text-slate-400 text-2xl mb-2"></i>
                                    <p class="text-xs text-slate-500">點擊上傳照片</p>
                                </div>
                                <img id="previewImg" class="hidden w-full h-32 object-cover rounded-lg">
                            </div>
                        </div>
                        <button type="submit" class="w-full bg-bio-accent hover:bg-emerald-400 text-bio-dark font-bold py-3 rounded-xl transition shadow-lg mt-4 flex items-center justify-center gap-2">
                            <i class="fa-solid fa-upload"></i> 上鏈數據 (Upload)
                        </button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <!-- Hero Section -->
    <header class="relative min-h-[90vh] flex items-center justify-center overflow-hidden">
        <div class="absolute inset-0 bg-hero-pattern bg-cover bg-center opacity-40"></div>
        <div class="absolute inset-0 bg-gradient-to-b from-bio-dark/80 via-bio-dark/90 to-bio-dark"></div>
        <div class="absolute inset-0 bg-noise opacity-20"></div>
        
        <div class="relative z-10 max-w-5xl mx-auto px-4 text-center">
            <div class="inline-block mb-6 px-4 py-2 rounded-full glass-panel border-bio-accent/20">
                <span class="text-bio-accent font-mono text-sm tracking-widest uppercase">2026 Biomimicry Design Challenge</span>
            </div>
            
            <h1 class="text-5xl md:text-7xl font-black text-white mb-8 leading-tight tracking-tight">
                像<span class="text-transparent bg-clip-text bg-gradient-to-r from-bio-accent to-blue-500 text-glow">菌絲</span>一樣思考：<br>
                啟動社區資源代謝網絡
            </h1>
            
            <p class="text-lg md:text-xl text-slate-400 max-w-2xl mx-auto mb-12 font-light leading-relaxed">
                <strong class="text-white">MycoTanJi</strong> 模仿森林地下的資源交換協議，將北大特區的「廢棄物」轉化為「可食地景」的養分。<br>
                這不僅是回收，這是一場關於<strong class="text-bio-accent">「修復、增益、再生」</strong>的城市微革命。
            </p>

            <div class="flex flex-col sm:flex-row gap-4 justify-center">
                <button onclick="document.getElementById('inputModal').classList.remove('hidden')" class="group relative px-8 py-4 bg-bio-accent text-bio-dark font-bold rounded-xl overflow-hidden hover:bg-emerald-400 transition-all shadow-[0_0_20px_rgba(16,185,129,0.4)]">
                    <span class="relative z-10 flex items-center gap-2">
                        <i class="fa-solid fa-plus"></i> 開始注入營養
                    </span>
                </button>
                <a href="#dashboard" class="px-8 py-4 glass-panel text-white font-bold rounded-xl hover:bg-white/10 transition-all border border-white/20 flex items-center justify-center gap-2">
                    <i class="fa-solid fa-chart-line text-bio-accent"></i> 即時數據監測
                </a>
            </div>
        </div>
    </header>

    <!-- Concept Section (Integrated with Interactive Visualization) -->
    <section id="concept" class="py-24 bg-bio-dark relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-16 items-center">
                
                <!-- Left Column: Interactive Network Visualization -->
                <div class="relative">
                    <div class="absolute -inset-4 bg-gradient-to-r from-bio-accent to-blue-600 rounded-2xl opacity-20 blur-xl"></div>
                    <div class="relative rounded-2xl glass-panel border border-white/10 overflow-hidden shadow-2xl">
                        <!-- Header Bar inside the frame -->
                        <div class="absolute top-4 left-4 z-20 bg-black/60 backdrop-blur px-3 py-1 rounded-full border border-white/10">
                            <span class="font-mono text-bio-accent text-xs">Fig 1.1 Live Simulation</span>
                        </div>
                        
                        <!-- The Network Container -->
                        <div id="canvas-container" class="network-container">
                            <div class="trees-bg"></div>
                            <div class="ground-line"></div>
                            
                            <!-- Floating Labels for Chemistry -->
                            <div id="c-label" class="floating-label text-yellow-400" style="top: 35%; left: 30%;">醣類 (C)</div>
                            <div id="p-label" class="floating-label text-blue-400" style="top: 70%; left: 55%;">磷 (P)</div>
                            <div id="n-label" class="floating-label text-blue-300" style="top: 80%; left: 20%;">氮 (N)</div>
                            <div id="sig-label" class="floating-label text-red-500 font-bold" style="top: 60%; left: 70%; opacity: 0; background: rgba(0,0,0,0.5); padding: 2px 6px rounded;">⚠️ 茉莉酸警訊</div>

                            <canvas id="network-canvas"></canvas>
                        </div>
                    </div>
                    <p class="mt-2 text-center text-xs text-slate-500">
                        <i class="fa-solid fa-mouse-pointer mr-1"></i> 點擊右側選項可切換網絡運作模式
                    </p>
                </div>

                <!-- Right Column: Interactive Text Controls -->
                <div class="space-y-8">
                    <div>
                        <h2 class="text-3xl md:text-4xl font-bold text-white mb-4">自然界的<span class="text-bio-accent">資源調度員</span></h2>
                        <div class="h-1 w-20 bg-bio-accent rounded-full mb-6"></div>
                        <p class="text-slate-400 text-lg leading-relaxed mb-6">
                            森林地底下存在一個龐大的「互聯網」— <strong class="text-white">菌根菌網絡 (Mycorrhizal Network)</strong>。它不只是依附植物生存，更是森林生態系的主動管理者。
                        </p>
                        
                        <div class="space-y-4">
                            <!-- Option 1: Trade -->
                            <div class="interactive-option rounded-xl p-3 flex gap-4 active" id="opt-trade" onclick="switchNetworkMode('trade')">
                                <div class="icon-box w-12 h-12 rounded-lg bg-bio-accent/10 flex items-center justify-center text-bio-accent shrink-0 transition-colors">
                                    <i class="fa-solid fa-handshake text-xl"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-bold text-lg mb-1">1. 交易 (Trade)</h4>
                                    <p class="text-sm text-slate-400 leading-snug">真菌提供土壤中難以取得的礦物質（磷 P、氮 N），換取植物光合作用產生的醣類（碳 C）。這是一種跨物種的經濟合約。</p>
                                </div>
                            </div>

                            <!-- Option 2: Communication -->
                            <div class="interactive-option rounded-xl p-3 flex gap-4" id="opt-signal" onclick="switchNetworkMode('signal')">
                                <div class="icon-box w-12 h-12 rounded-lg bg-red-500/10 flex items-center justify-center text-red-400 shrink-0 transition-colors">
                                    <i class="fa-solid fa-tower-broadcast text-xl"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-bold text-lg mb-1">2. 通訊 (Communication)</h4>
                                    <p class="text-sm text-slate-400 leading-snug">當一棵樹被蟲咬，它會透過菌絲向鄰近樹木發送「茉莉酸」等化學警訊，啟動整體的防禦機制。</p>
                                </div>
                            </div>

                            <!-- Option 3: Redistribution -->
                            <div class="interactive-option rounded-xl p-3 flex gap-4" id="opt-redistribute" onclick="switchNetworkMode('redistribute')">
                                <div class="icon-box w-12 h-12 rounded-lg bg-blue-500/10 flex items-center justify-center text-blue-400 shrink-0 transition-colors">
                                    <i class="fa-solid fa-truck-fast text-xl"></i>
                                </div>
                                <div>
                                    <h4 class="text-white font-bold text-lg mb-1">3. 重分配 (Redistribution)</h4>
                                    <p class="text-sm text-slate-400 leading-snug">菌絲會偵測資源濃度，將養分從富饒的「源頭」輸送到貧瘠的「庫」，維持生態系的動態平衡。</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Solution / Workflow Section -->
    <section id="solution" class="py-24 bg-slate-900 relative overflow-hidden">
        <div class="absolute left-1/2 top-0 bottom-0 w-px bg-gradient-to-b from-transparent via-bio-accent/30 to-transparent hidden md:block"></div>
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="text-center mb-16">
                <span class="text-bio-accent font-mono text-sm tracking-wider uppercase">System Workflow</span>
                <h2 class="text-3xl md:text-4xl font-bold text-white mt-2">三峽在地循環模型</h2>
                <p class="text-slate-400 mt-4">連結 <span class="text-white font-bold">北大特區商家</span> 與 <span class="text-white font-bold">麗寶萊茵社區</span> 的實證計畫</p>
            </div>
            <div class="space-y-12 md:space-y-24">
                <!-- Input -->
                <div class="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-16">
                    <div class="w-full md:w-1/2 text-right md:pr-12 space-y-4 order-2 md:order-1">
                        <div class="inline-block px-3 py-1 rounded bg-slate-800 text-slate-300 text-xs font-mono mb-2">Input / 營養源</div>
                        <h3 class="text-2xl font-bold text-white">城市裡的有機礦脈</h3>
                        <p class="text-slate-400">三峽北大特區密集分佈的連鎖便利商店與咖啡店，每日產生大量潔淨的咖啡渣。這些是富含氮源的有機資材，目前卻多被視為垃圾。</p>
                    </div>
                    <div class="w-full md:w-1/2 order-1 md:order-2">
                        <div class="relative w-32 h-32 md:w-48 md:h-48 mx-auto bg-slate-800 rounded-full border-2 border-slate-700 flex items-center justify-center overflow-hidden">
                            <i class="fa-solid fa-mug-hot text-5xl md:text-7xl text-amber-500"></i>
                        </div>
                    </div>
                </div>
                <!-- Process -->
                <div class="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-16">
                    <div class="w-full md:w-1/2 md:text-right order-1">
                        <div class="relative w-40 h-40 md:w-56 md:h-56 mx-auto bg-slate-800 rounded-full border-2 border-bio-accent flex items-center justify-center overflow-hidden z-20">
                            <i class="fa-solid fa-arrows-rotate text-6xl md:text-8xl text-bio-accent animate-spin" style="animation-duration: 10s;"></i>
                        </div>
                    </div>
                    <div class="w-full md:w-1/2 md:pl-12 space-y-4 order-2">
                        <div class="inline-block px-3 py-1 rounded bg-slate-800 text-slate-300 text-xs font-mono mb-2">Process / 轉化</div>
                        <h3 class="text-2xl font-bold text-white">數位菌絲中繼站</h3>
                        <p class="text-slate-400">透過平台接收「釋出訊號」。利用回頭車或散步路徑，將物資運回社區堆肥站。混合社區落葉（碳源），進行好氧發酵。</p>
                    </div>
                </div>
                <!-- Output -->
                <div class="flex flex-col md:flex-row items-center justify-center gap-8 md:gap-16">
                    <div class="w-full md:w-1/2 text-right md:pr-12 space-y-4 order-2 md:order-1">
                        <div class="inline-block px-3 py-1 rounded bg-slate-800 text-slate-300 text-xs font-mono mb-2">Output / 再生</div>
                        <h3 class="text-2xl font-bold text-white">社區可食地景</h3>
                        <p class="text-slate-400">熟成的黑金堆肥，直接用於頂樓農園。種出的薄荷、迷迭香、萵苣，再回饋給住戶或咖啡店，完成完美的閉鎖循環。</p>
                    </div>
                    <div class="w-full md:w-1/2 order-1 md:order-2">
                        <div class="relative w-32 h-32 md:w-48 md:h-48 mx-auto bg-slate-800 rounded-full border-2 border-slate-700 flex items-center justify-center overflow-hidden">
                            <i class="fa-solid fa-seedling text-5xl md:text-7xl text-green-500 float-animation"></i>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Timeline Section -->
    <section id="timeline" class="py-24 bg-slate-900 relative">
        <div class="max-w-5xl mx-auto px-4 sm:px-6 lg:px-8 relative">
            <div class="text-center mb-16">
                <span class="text-bio-accent font-mono text-sm tracking-wider uppercase">Ecological Succession</span>
                <h2 class="text-3xl md:text-4xl font-bold text-white mt-2">生態演替時間軸</h2>
                <p class="text-slate-400 mt-4">見證從「廢棄物」到「可食地景」的轉化過程</p>
            </div>
            <div class="relative py-10" id="timelineContainer">
                <div class="timeline-line"></div>
            </div>
        </div>
    </section>

    <!-- Dashboard Section -->
    <section id="dashboard" class="py-24 bg-bio-dark relative">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="glass-panel rounded-2xl p-6 md:p-8 border border-white/10 shadow-2xl relative overflow-hidden">
                <div class="absolute inset-0 bg-[url('https://www.transparenttextures.com/patterns/graphy.png')] opacity-10"></div>
                <div class="flex justify-between items-center mb-8 relative z-10">
                    <div>
                        <h3 class="text-xl font-bold text-white">碳代謝戰情室 (Carbon Dashboard)</h3>
                        <p class="text-xs text-slate-400 font-mono">Scope 3 Emissions Avoidance</p>
                    </div>
                    <div class="text-right">
                        <p class="text-xs text-slate-400">Last updated</p>
                        <p class="text-bio-accent font-mono" id="current-time">Loading...</p>
                    </div>
                </div>
                <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-8 relative z-10">
                    <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5 text-center group hover:border-bio-accent/50 transition">
                        <div class="text-xs text-slate-400 mb-1">總攔截廢棄物</div>
                        <div class="text-3xl font-mono font-bold text-amber-400" id="totalWeight">0</div>
                        <div class="text-[10px] text-slate-500">kg</div>
                    </div>
                    <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5 text-center group hover:border-bio-accent/50 transition">
                        <div class="text-xs text-slate-400 mb-1">迴避碳排放量</div>
                        <div class="text-3xl font-mono font-bold text-bio-accent" id="totalCarbon">0</div>
                        <div class="text-[10px] text-slate-500">kg CO2e</div>
                    </div>
                    <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5 text-center group hover:border-bio-accent/50 transition">
                        <div class="text-xs text-slate-400 mb-1">產生有機沃土</div>
                        <div class="text-3xl font-mono font-bold text-bio-soil" id="totalSoil">0</div>
                        <div class="text-[10px] text-slate-500">kg (轉化率70%)</div>
                    </div>
                    <div class="bg-slate-800/50 p-4 rounded-xl border border-white/5 text-center group hover:border-bio-accent/50 transition">
                        <div class="text-xs text-slate-400 mb-1">節省社區公款</div>
                        <div class="text-3xl font-mono font-bold text-blue-400" id="totalMoney">0</div>
                        <div class="text-[10px] text-slate-500">TWD (肥料/垃圾費)</div>
                    </div>
                </div>
                <div class="relative h-64 w-full z-10">
                    <canvas id="carbonChart"></canvas>
                </div>
            </div>
        </div>
    </section>

    <!-- Impact Section -->
    <section id="impact" class="py-24 bg-slate-900 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="text-center mb-16">
                <h2 class="text-3xl font-bold text-white mb-4">全方位永續效益</h2>
                <p class="text-slate-400 max-w-2xl mx-auto">對應新北市三大局處政策目標，實現 Nature Positive 願景</p>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 mb-20">
                <!-- Agriculture -->
                <div class="group p-8 rounded-2xl bg-bio-dark border border-slate-800 hover:border-green-500 transition duration-500 relative overflow-hidden">
                    <div class="absolute inset-0 bg-green-500/5 opacity-0 group-hover:opacity-100 transition duration-500"></div>
                    <div class="w-16 h-16 mx-auto bg-green-500/10 rounded-full flex items-center justify-center text-green-500 text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fa-solid fa-wheat-awn"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3 text-center">都市農業創新</h3>
                    <p class="text-slate-400 text-sm leading-relaxed text-center">響應<strong>永續農漁業</strong>願景。將水泥叢林轉化為生產基地，利用回收養分種植蔬菜，縮短食物里程至「0公里」，實踐都市農耕創新。</p>
                </div>
                <!-- Environment -->
                <div class="group p-8 rounded-2xl bg-bio-dark border border-slate-800 hover:border-amber-500 transition duration-500 relative overflow-hidden">
                    <div class="absolute inset-0 bg-amber-500/5 opacity-0 group-hover:opacity-100 transition duration-500"></div>
                    <div class="w-16 h-16 mx-auto bg-amber-500/10 rounded-full flex items-center justify-center text-amber-500 text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fa-solid fa-trash-arrow-up"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3 text-center">循環經濟減量</h3>
                    <p class="text-slate-400 text-sm leading-relaxed text-center">呼應<strong>循環經濟減量</strong>策略。從源頭分流有機廢棄物，減輕新北市焚化爐負荷，實現「搖籃到搖籃」的閉鎖循環。</p>
                </div>
                <!-- City (Secretariat) -->
                <div class="group p-8 rounded-2xl bg-bio-dark border border-slate-800 hover:border-blue-500 transition duration-500 relative overflow-hidden">
                    <div class="absolute inset-0 bg-blue-500/5 opacity-0 group-hover:opacity-100 transition duration-500"></div>
                    <div class="w-16 h-16 mx-auto bg-blue-500/10 rounded-full flex items-center justify-center text-blue-500 text-2xl mb-6 group-hover:scale-110 transition">
                        <i class="fa-solid fa-city"></i>
                    </div>
                    <h3 class="text-xl font-bold text-white mb-3 text-center">永續韌性城市</h3>
                    <p class="text-slate-400 text-sm leading-relaxed text-center">對接<strong>永續城市</strong>發展指標。透過公私協力夥伴關係 (SDG 17)，建構低碳韌性社區，實踐永續城鄉 (SDG 11) 願景，提升國際能見度。</p>
                </div>
            </div>

            <!-- Future Roadmap -->
            <div class="glass-panel border border-white/10 rounded-3xl p-8 md:p-12 relative overflow-hidden">
                <div class="absolute -right-20 -top-20 w-64 h-64 bg-bio-accent/20 rounded-full blur-3xl"></div>
                
                <h3 class="text-2xl font-bold text-white mb-8 flex items-center">
                    <i class="fa-solid fa-map-location-dot text-bio-accent mr-3"></i> 未來展望：新北市推動路徑
                </h3>
                
                <div class="grid grid-cols-1 md:grid-cols-3 gap-8 relative">
                    <!-- Connecting Line -->
                    <div class="hidden md:block absolute top-8 left-0 w-full h-0.5 bg-gradient-to-r from-bio-accent to-blue-500 opacity-30"></div>

                    <!-- Phase 1 -->
                    <div class="relative z-10">
                        <div class="w-16 h-16 rounded-full bg-bio-dark border-2 border-bio-accent flex items-center justify-center text-white font-bold text-lg mb-4 shadow-[0_0_15px_rgba(16,185,129,0.3)]">2026</div>
                        <h4 class="text-lg font-bold text-bio-accent mb-2">北大特區示範點</h4>
                        <p class="text-sm text-slate-400 leading-relaxed">
                            以三峽北大特區為起點，串聯便利商店、咖啡店與社區，建立 SOP 與數據驗證模型。
                        </p>
                    </div>

                    <!-- Phase 2 -->
                    <div class="relative z-10">
                        <div class="w-16 h-16 rounded-full bg-bio-dark border-2 border-blue-400 flex items-center justify-center text-white font-bold text-lg mb-4">2027</div>
                        <h4 class="text-lg font-bold text-blue-400 mb-2">擴散至氣候挑戰區</h4>
                        <p class="text-sm text-slate-400 leading-relaxed">
                            拓展至淡水、林口等新興市鎮，針對其低溫潮濕氣候特性，導入溫控與抗風植栽，驗證系統的高適應性。
                        </p>
                    </div>

                    <!-- Phase 3 -->
                    <div class="relative z-10">
                        <div class="w-16 h-16 rounded-full bg-bio-dark border-2 border-purple-500 flex items-center justify-center text-white font-bold text-lg mb-4">2030</div>
                        <h4 class="text-lg font-bold text-purple-500 mb-2">全市淨零模組</h4>
                        <p class="text-sm text-slate-400 leading-relaxed">
                            納入新北市「2050 淨零路徑」，建立「社區碳匯」模組，豐富市民的永續生活履歷。
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="bg-bio-dark py-12 border-t border-slate-800">
        <div class="max-w-7xl mx-auto px-4 text-center space-y-4">
            <div class="flex items-center justify-center gap-2 mb-4">
                <i class="fa-solid fa-circle-nodes text-bio-accent"></i>
                <span class="font-bold text-lg text-white">MycoTanJi</span>
            </div>
            <p class="text-slate-500 text-sm">
                2026 台灣仿生設計競賽參賽作品 | 新北市三峽區在地實踐
            </p>
            <p class="text-slate-600 text-xs">
                作品受著作權法保護，未經授權請勿複製轉載｜歡迎聯絡我們：tanji2026@gmail.com
            </p>
        </div>
    </footer>

    <!-- Scripts -->
    <script>
        // --- 1. Main Dashboard & Data Logic ---
        const initialData = [
            {
                id: 1,
                date: '2026-02-02',
                source: 'Louisa',
                type: 'Coffee Grounds',
                weight: 3.5,
                img: 'https://images.unsplash.com/photo-1510257321689-53a5db7f516a?auto=format&fit=crop&q=80&w=400',
                desc: '本月首批回收，啟動 1 號堆肥箱。'
            },
            {
                id: 2,
                date: '2026-02-05',
                source: 'Community',
                type: 'Leaves',
                weight: 1.2,
                img: 'https://images.unsplash.com/photo-1596434455581-4204c35e982c?auto=format&fit=crop&q=80&w=400',
                desc: '收集社區中庭落葉，調整碳氮比 (C/N)。'
            },
            {
                id: 3,
                date: '2026-02-08',
                source: 'Starbucks',
                type: 'Coffee Grounds',
                weight: 5.0,
                img: 'https://images.unsplash.com/photo-1621258079047-9e7949c86940?auto=format&fit=crop&q=80&w=400',
                desc: '星巴克夥伴支援，大量高品質咖啡渣注入！'
            },
            {
                id: 4,
                date: '2026-02-20',
                source: 'MycoTanJi',
                type: 'Soil',
                weight: 8.5,
                img: 'https://images.unsplash.com/photo-1464226184884-fa280b87c399?auto=format&fit=crop&q=80&w=400',
                desc: '黑金土熟成完畢，開始定植迷迭香與萵苣。'
            },
            {
                id: 5,
                date: '2026-03-20',
                source: 'MycoTanJi',
                type: 'Harvest',
                weight: 2.0,
                img: 'https://images.unsplash.com/photo-1530836369250-ef72a3f5cda8?auto=format&fit=crop&q=80&w=400',
                desc: '首批可食地景採收，迷迭香回饋社區居民，共享低碳生活成果。'
            }
        ];

        let appData = JSON.parse(localStorage.getItem('mycoData')) || [...initialData];
        let chartInstance = null;

        function initChart() {
            const ctx = document.getElementById('carbonChart').getContext('2d');
            const gradient = ctx.createLinearGradient(0, 0, 0, 400);
            gradient.addColorStop(0, 'rgba(16, 185, 129, 0.5)');
            gradient.addColorStop(1, 'rgba(16, 185, 129, 0)');

            const labels = appData.map(d => d.date.substring(5));
            let cum = 0;
            const dataPoints = appData.map(d => {
                cum += d.weight * 0.56;
                return cum;
            });

            chartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: '累積減碳效益 (kg CO2e)',
                        data: dataPoints,
                        borderColor: '#10b981',
                        backgroundColor: gradient,
                        borderWidth: 2,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#10b981',
                        fill: true,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { labels: { color: '#94a3b8' } } },
                    scales: {
                        y: { grid: { color: 'rgba(255, 255, 255, 0.05)' }, ticks: { color: '#64748b' } },
                        x: { grid: { display: false }, ticks: { color: '#64748b' } }
                    }
                }
            });
        }

        function updateDashboard() {
            let totalW = 0;
            appData.forEach(d => totalW += d.weight);
            let totalC = totalW * 0.56; 
            let totalS = totalW * 0.7; 
            let totalM = totalW * 20;

            animateValue('totalWeight', totalW, 1);
            animateValue('totalCarbon', totalC, 1);
            animateValue('totalSoil', totalS, 1);
            animateValue('totalMoney', totalM, 0);
        }

        function renderTimeline(highlightId = null) {
            const container = document.getElementById('timelineContainer');
            container.innerHTML = '<div class="timeline-line"></div>';
            const sortedData = [...appData].sort((a, b) => new Date(a.date) - new Date(b.date));

            sortedData.forEach((item, index) => {
                const isLeft = index % 2 === 0;
                const highlightClass = (highlightId && item.id === highlightId) ? 'new-entry-highlight' : '';
                
                const itemHTML = `
                    <div id="item-${item.id}" class="mb-8 flex justify-between items-center w-full md:flex-row flex-col ${isLeft ? 'md:flex-row-reverse' : ''} animate-grow" style="animation-delay: ${index * 0.1}s">
                        <div class="order-1 w-5/12 hidden md:block"></div>
                        <div class="z-20 flex items-center order-1 bg-bio-dark border-2 border-bio-accent rounded-full w-8 h-8 justify-center shadow-[0_0_10px_rgba(16,185,129,0.5)]"></div>
                        <div class="order-1 md:w-5/12 w-full px-4 md:px-0 mt-4 md:mt-0">
                            <div class="glass-panel border border-white/10 rounded-xl p-4 hover:border-bio-accent/50 transition duration-300 ${highlightClass}">
                                <div class="flex justify-between items-start mb-2">
                                    <span class="text-xs font-mono text-bio-accent bg-bio-accent/10 px-2 py-1 rounded">${item.date}</span>
                                    <span class="text-xs text-slate-400 flex items-center gap-1"><i class="fa-solid fa-weight-hanging"></i> ${item.weight}kg</span>
                                </div>
                                <h4 class="font-bold text-white mb-2 text-lg">${item.source} <span class="text-sm font-normal text-slate-400">/ ${item.type}</span></h4>
                                ${item.img ? `<div class="h-32 w-full rounded-lg overflow-hidden mb-3"><img src="${item.img}" class="w-full h-full object-cover"></div>` : ''}
                                <p class="text-sm text-slate-300">${item.desc}</p>
                            </div>
                        </div>
                    </div>
                `;
                container.insertAdjacentHTML('beforeend', itemHTML);
            });
        }

        function toggleInputModal() {
            document.getElementById('inputModal').classList.toggle('hidden');
        }

        function previewImage(input) {
            if (input.files && input.files[0]) {
                const reader = new FileReader();
                reader.onload = function(e) {
                    const img = document.getElementById('previewImg');
                    img.src = e.target.result;
                    img.classList.remove('hidden');
                    document.getElementById('imagePreviewBox').classList.add('hidden');
                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        function handleDataSubmit(e) {
            e.preventDefault();
            const source = document.getElementById('inputSource').value;
            const type = document.getElementById('inputType').value;
            const weight = parseFloat(document.getElementById('inputWeight').value);
            const imgInput = document.getElementById('inputImage');
            const today = new Date().toISOString().split('T')[0];
            
            let imgUrl = 'https://images.unsplash.com/photo-1542601906990-b4d3fb778b09?auto=format&fit=crop&q=80&w=400';
            if (imgInput.files && imgInput.files[0]) {
                imgUrl = URL.createObjectURL(imgInput.files[0]);
            }

            const newId = Date.now();
            const newData = {
                id: newId,
                date: today,
                source: source,
                type: type,
                weight: weight,
                img: imgUrl,
                desc: `成功上鏈！來自 ${source} 的資源已進入循環系統。`
            };

            appData.push(newData);
            localStorage.setItem('mycoData', JSON.stringify(appData));
            updateDashboard();
            renderTimeline(newId);
            
            if(chartInstance) {
                const newTotalWeight = appData.reduce((acc, cur) => acc + cur.weight, 0);
                chartInstance.data.labels.push(today.substring(5));
                chartInstance.data.datasets[0].data.push(newTotalWeight * 0.56);
                chartInstance.update();
            }

            e.target.reset();
            document.getElementById('previewImg').classList.add('hidden');
            document.getElementById('imagePreviewBox').classList.remove('hidden');
            toggleInputModal();
            setTimeout(() => {
                const newItem = document.getElementById(`item-${newId}`);
                if (newItem) newItem.scrollIntoView({ behavior: 'smooth', block: 'center' });
            }, 300);
        }

        function animateValue(id, end, decimals) {
            const obj = document.getElementById(id);
            const start = parseFloat(obj.innerHTML);
            const duration = 1000;
            let startTimestamp = null;
            const step = (timestamp) => {
                if (!startTimestamp) startTimestamp = timestamp;
                const progress = Math.min((timestamp - startTimestamp) / duration, 1);
                obj.innerHTML = (progress * (end - start) + start).toFixed(decimals);
                if (progress < 1) window.requestAnimationFrame(step);
            };
            window.requestAnimationFrame(step);
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('current-time').innerText = now.toLocaleString('zh-TW', { hour12: false });
        }

        // --- 2. Mycorrhizal Network Animation Logic ---
        const canvas = document.getElementById('network-canvas');
        const ctx = canvas.getContext('2d');
        const container = document.getElementById('canvas-container');
        
        let width, height;
        let particles = [];
        let nodes = [];
        let links = [];
        let currentMode = 'trade';

        function initNetwork() {
            resizeNetwork();
            createNetwork();
            animateNetwork();
        }

        function resizeNetwork() {
            // Important: Use container size, not window size
            width = canvas.width = container.clientWidth;
            height = canvas.height = container.clientHeight;
        }

        function createNetwork() {
            nodes = [];
            links = [];
            // Create root nodes (top area)
            const treeCount = 5;
            for (let i = 0; i < treeCount; i++) {
                nodes.push({
                    id: `tree-${i}`,
                    x: (width / (treeCount + 1)) * (i + 1),
                    y: 10, // Near the top of the canvas (which starts at 45% of container)
                    radius: 8,
                    type: 'root',
                    color: '#4ade80'
                });
            }
            // Create fungi nodes
            const rows = 4;
            const cols = 8;
            for (let r = 0; r < rows; r++) {
                for (let c = 0; c < cols; c++) {
                    nodes.push({
                        id: `fungi-${r}-${c}`,
                        x: (width / (cols + 1)) * (c + 1) + (Math.random() * 40 - 20),
                        y: (height / (rows + 1)) * (r + 1) + 20,
                        radius: 3,
                        type: 'fungi',
                        color: '#444'
                    });
                }
            }
            // Links
            nodes.forEach((n1, i) => {
                nodes.forEach((n2, j) => {
                    if (i === j) return;
                    const dist = Math.sqrt((n1.x - n2.x)**2 + (n1.y - n2.y)**2);
                    if (dist < width * 0.15) {
                        if (Math.random() > 0.85 || (n1.type === 'root' && dist < 100)) {
                            links.push({ from: n1, to: n2 });
                        }
                    }
                });
            });
        }

        class Particle {
            constructor(link, type) {
                this.link = link;
                this.type = type;
                this.progress = Math.random();
                this.speed = 0.002 + Math.random() * 0.004;
                this.color = type === 'carbon' ? '#ffcc00' : (type === 'signal' ? '#ff4d4d' : '#00d4ff');
            }
            update() {
                this.progress += this.speed;
                if (this.progress > 1) this.progress = 0;
            }
            draw() {
                // Safety check: ensure link and nodes exist
                if (!this.link || !this.link.from || !this.link.to) return;

                const x = this.link.from.x + (this.link.to.x - this.link.from.x) * this.progress;
                const y = this.link.from.y + (this.link.to.y - this.link.from.y) * this.progress;
                ctx.beginPath();
                ctx.arc(x, y, 2.5, 0, Math.PI * 2);
                ctx.fillStyle = this.color;
                ctx.shadowBlur = 10;
                ctx.shadowColor = this.color;
                ctx.fill();
                ctx.shadowBlur = 0;
            }
        }

        function switchNetworkMode(mode) {
            currentMode = mode;
            particles = [];
            
            // Safety check: Don't create particles if no links exist
            if (!links || links.length === 0) return;

            // Highlight interactive buttons
            document.querySelectorAll('.interactive-option').forEach(el => el.classList.remove('active'));
            document.getElementById('opt-' + mode).classList.add('active');

            // Toggle Signal Label
            document.getElementById('sig-label').style.opacity = (mode === 'signal') ? '1' : '0';
            
            const particleCount = 40;
            for (let i = 0; i < particleCount; i++) {
                const link = links[Math.floor(Math.random() * links.length)];
                if (link) { // Ensure link is valid before creating particle
                    let type = 'mineral';
                    if (mode === 'trade') type = Math.random() > 0.5 ? 'carbon' : 'mineral';
                    else if (mode === 'signal') type = 'signal';
                    else type = 'mineral'; // redistribute
                    particles.push(new Particle(link, type));
                }
            }
        }

        function animateNetwork() {
            ctx.clearRect(0, 0, width, height);
            
            // Draw links
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            links.forEach(l => {
                ctx.beginPath();
                ctx.moveTo(l.from.x, l.from.y);
                ctx.lineTo(l.to.x, l.to.y);
                ctx.stroke();
            });

            // Draw nodes
            nodes.forEach(n => {
                ctx.beginPath();
                ctx.arc(n.x, n.y, n.radius, 0, Math.PI * 2);
                ctx.fillStyle = n.type === 'root' ? '#4ade80' : 'rgba(255, 255, 255, 0.2)';
                ctx.fill();
                if (n.type === 'root') {
                    ctx.shadowBlur = 15;
                    ctx.shadowColor = '#4ade80';
                    ctx.stroke();
                    ctx.shadowBlur = 0;
                }
            });

            // Init particles if empty and links exist
            if (particles.length === 0 && links.length > 0) switchNetworkMode('trade');
            
            // Animate particles
            particles.forEach(p => {
                p.update();
                p.draw();
            });

            requestAnimationFrame(animateNetwork);
        }

        // --- 3. Global Init ---
        window.onload = function() {
            // Dashboard Init
            updateTime();
            setInterval(updateTime, 1000);
            updateDashboard();
            renderTimeline();
            initChart();

            // Network Canvas Init with slight delay to ensure layout
            setTimeout(() => {
                initNetwork();
            }, 100);
            window.addEventListener('resize', resizeNetwork);
        };
    </script>
</body>
</html>
