<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>台電批次帳單匯出流程圖 (多電號版)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .canvas-bg {
            background-color: #f8fafc;
            background-image: radial-gradient(#cbd5e1 1px, transparent 1px);
            background-size: 20px 20px;
        }
    </style>
</head>
<body class="bg-slate-100 min-h-screen flex flex-col items-center justify-center p-4">

    <!-- 控制面板 -->
    <div class="mb-6 bg-white p-4 rounded-xl shadow-sm border border-slate-200 flex gap-4 items-center max-w-3xl w-full justify-between">
        <div>
            <h1 class="text-lg font-bold text-slate-800">⚡ 企業多廠區/多電號 電費資料收集</h1>
            <p class="text-sm text-slate-500">免找紙本，一鍵匯出全年碳盤查數據（支援多筆電號同時下載）</p>
        </div>
        <button id="download-btn" class="bg-blue-600 hover:bg-blue-700 text-white px-5 py-2.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 shadow-sm">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
            </svg>
            下載 SVG 圖片
        </button>
    </div>

    <!-- 獨立的 SVG 容器 -->
    <div id="svg-wrapper" class="bg-white p-8 rounded-2xl shadow-lg border border-slate-200 overflow-hidden canvas-bg flex justify-center w-full max-w-4xl">
        
        <!-- 手工打造的高質感 SVG 流程圖 -->
        <svg id="workflow-svg" xmlns="http://www.w3.org/2000/svg" width="850" height="500" viewBox="0 0 850 500" style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;">
            <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
                    <polygon points="0 0, 10 3.5, 0 7" fill="#64748b" />
                </marker>
                <filter id="shadow" x="-10%" y="-10%" width="120%" height="120%">
                    <feDropShadow dx="0" dy="4" stdDeviation="4" flood-color="#0f172a" flood-opacity="0.08"/>
                </filter>
                <filter id="shadow-light" x="-10%" y="-10%" width="120%" height="120%">
                    <feDropShadow dx="0" dy="2" stdDeviation="2" flood-color="#0f172a" flood-opacity="0.05"/>
                </filter>
            </defs>

            <!-- ================= 連線 (Edges) ================= -->
            <!-- 步驟1 到 步驟2 -->
            <path d="M 220 120 C 220 180, 220 180, 220 240" fill="none" stroke="#64748b" stroke-width="3" stroke-dasharray="6,4" marker-end="url(#arrowhead)"/>
            
            <!-- 步驟2 到 步驟3 -->
            <path d="M 220 320 C 220 400, 380 400, 420 400" fill="none" stroke="#64748b" stroke-width="3" stroke-dasharray="6,4" marker-end="url(#arrowhead)"/>
            
            <!-- 痛點箭頭：從痛點跳到解法 -->
            <path d="M 620 150 C 620 280, 620 300, 620 350" fill="none" stroke="#3b82f6" stroke-width="4" marker-end="url(#arrowhead)"/>
            
            <!-- 連接說明文字 -->
            <line x1="300" y1="80" x2="360" y2="80" stroke="#cbd5e1" stroke-width="2"/>
            <line x1="300" y1="280" x2="360" y2="280" stroke="#cbd5e1" stroke-width="2"/>


            <!-- ================= 節點 (Nodes) ================= -->
            
            <!-- 標題區域 -->
            <rect x="50" y="10" width="750" height="40" rx="8" fill="#f1f5f9" />
            <text x="425" y="35" text-anchor="middle" font-size="16" font-weight="bold" fill="#334155">【企業碳盤查】台電電子帳單 批次匯出流程 (多電號適用)</text>

            <!-- ================= 左側：操作步驟 ================= -->
            
            <!-- 步驟 1 -->
            <g transform="translate(140, 60)">
                <rect width="160" height="60" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#3b82f6" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">1</text>
                <text x="80" y="35" text-anchor="middle" font-size="15" font-weight="bold" fill="#1e293b">登入台電系統</text>
            </g>
            <!-- 步驟 1 說明 -->
            <g transform="translate(360, 65)">
                <rect width="190" height="50" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow-light)"/>
                <text x="95" y="23" text-anchor="middle" font-size="12" fill="#475569">使用公司「統編」與「密碼」</text>
                <text x="95" y="40" text-anchor="middle" font-size="12" fill="#475569">登入電子帳單服務網</text>
            </g>

            <!-- 步驟 2 -->
            <g transform="translate(140, 240)">
                <rect width="160" height="80" rx="12" fill="#ffffff" stroke="#e2e8f0" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#3b82f6" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">2</text>
                <text x="80" y="35" text-anchor="middle" font-size="15" font-weight="bold" fill="#1e293b">選擇批次匯出</text>
                <text x="80" y="55" text-anchor="middle" font-size="12" fill="#64748b">帳單查詢 > 明細匯出</text>
            </g>
            <!-- 步驟 2 說明 -->
            <g transform="translate(360, 255)">
                <rect width="190" height="50" rx="6" fill="#f8fafc" stroke="#cbd5e1" stroke-width="1" filter="url(#shadow-light)"/>
                <text x="95" y="23" text-anchor="middle" font-size="12" fill="#475569">選擇需盤查的年度區間</text>
                <text x="95" y="40" text-anchor="middle" font-size="12" fill="#475569">(例如：113年1月~12月)</text>
            </g>

            <!-- ================= 右側：痛點對比 (多電號情境) ================= -->
            
            <g transform="translate(460, 60)">
                <!-- 痛點背景底框 -->
                <rect width="320" height="90" rx="8" fill="#fee2e2" stroke="#fca5a5" stroke-width="2" stroke-dasharray="4"/>
                <text x="160" y="30" text-anchor="middle" font-size="15" font-weight="bold" fill="#b91c1c">❌ 傳統痛點：多廠區/多樓層</text>
                
                <!-- 痛點細節 -->
                <rect x="20" y="40" width="130" height="30" rx="4" fill="#fef2f2" stroke="#fca5a5" stroke-width="1"/>
                <text x="85" y="59" text-anchor="middle" font-size="11" fill="#991b1b">A廠區 (10個電表)</text>
                
                <rect x="170" y="40" width="130" height="30" rx="4" fill="#fef2f2" stroke="#fca5a5" stroke-width="1"/>
                <text x="235" y="59" text-anchor="middle" font-size="11" fill="#991b1b">辦公室 (3個樓層)</text>
                
                <text x="160" y="80" text-anchor="middle" font-size="12" font-weight="bold" fill="#7f1d1d">紙本帳單散落各地，收集困難！</text>
            </g>

            <!-- ================= 最終成果：步驟 3 ================= -->
            <g transform="translate(420, 360)">
                <rect width="320" height="100" rx="12" fill="#ecfeff" stroke="#06b6d4" stroke-width="2" filter="url(#shadow)"/>
                <circle cx="20" cy="20" r="14" fill="#0ea5e9" />
                <text x="20" y="25" text-anchor="middle" font-size="14" font-weight="bold" fill="white">3</text>
                <text x="160" y="35" text-anchor="middle" font-size="18" font-weight="bold" fill="#0369a1">✅ 一鍵下載 全公司總表</text>
                
                <!-- 亮點標籤 -->
                <rect x="30" y="50" width="80" height="24" rx="12" fill="#cffafe" />
                <text x="70" y="66" text-anchor="middle" font-size="11" font-weight="bold" fill="#0284c7">統編自動歸戶</text>
                
                <rect x="120" y="50" width="80" height="24" rx="12" fill="#cffafe" />
                <text x="160" y="66" text-anchor="middle" font-size="11" font-weight="bold" fill="#0284c7">包含碳排量</text>
                
                <rect x="210" y="50" width="80" height="24" rx="12" fill="#cffafe" />
                <text x="250" y="66" text-anchor="middle" font-size="11" font-weight="bold" fill="#0284c7">全年度度數</text>

                <text x="160" y="90" text-anchor="middle" font-size="12" fill="#0891b2">免人工加總，直接提供給輔導顧問！</text>
            </g>

            <!-- ================= 裝飾性標籤 ================= -->
            <rect x="190" y="155" width="60" height="20" rx="10" fill="#e2e8f0" />
            <text x="220" y="169" text-anchor="middle" font-size="11" font-weight="bold" fill="#64748b">系統自動</text>

            <rect x="580" y="210" width="80" height="24" rx="12" fill="#bfdbfe" />
            <text x="620" y="226" text-anchor="middle" font-size="12" font-weight="bold" fill="#1d4ed8">統編綁定解法</text>

        </svg>
    </div>

    <!-- 腳本：處理下載功能 -->
    <script>
        document.getElementById('download-btn').addEventListener('click', () => {
            const svgElement = document.getElementById('workflow-svg');
            
            const serializer = new XMLSerializer();
            let source = serializer.serializeToString(svgElement);

            if(!source.match(/^<\?xml[^>]+>/)){
                source = '<?xml version="1.0" standalone="no"?>\r\n' + source;
            }

            const blob = new Blob([source], {type: "image/svg+xml;charset=utf-8"});
            const url = URL.createObjectURL(blob);

            const link = document.createElement("a");
            link.href = url;
            link.download = "台電多電號匯出流程.svg";
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        });
    </script>
</body>
</html>
